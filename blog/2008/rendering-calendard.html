<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CoffeaElectronica.com</title>

    <meta name="description" content="A technical blog.">
    <meta name="author" content="Christopher J. Stehno">
    <meta name="keywords" content="java,groovy,blog">
    <meta name="generator" content="JBake">

    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/asciidoctor.css" rel="stylesheet">
    <link href="/css/base.css" rel="stylesheet">
    <link href="/css/prettify.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="/favicon.ico">
</head>

<body onload="prettyPrint()">

<div class="container-fluid">

    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12">
            <img src="/images/coffee-banner.jpg" class="img-responsive" />
        </div>
    </div>

    <nav class="navbar navbar-inverse" style="margin-bottom: 2px;">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/index.html">&nbsp;CoffeaElectronica</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li><a href="/index.html">Home</a></li>
                    <li><a href="/about.html">About</a></li>
                    <li><a href="/feed.xml">Feed</a></li>
                    <li><a href="/archive.html">Archive</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Tags <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            
                                    <li><a href="/tags/ant.html">ant</a></li>
                            
                                    <li><a href="/tags/blog.html">blog</a></li>
                            
                                    <li><a href="/tags/gradle.html">gradle</a></li>
                            
                                    <li><a href="/tags/groovy.html">groovy</a></li>
                            
                                    <li><a href="/tags/java.html">java</a></li>
                            
                                    <li><a href="/tags/javascript.html">javascript</a></li>
                            
                                    <li><a href="/tags/maven.html">maven</a></li>
                            
                                    <li><a href="/tags/python.html">python</a></li>
                            
                                    <li><a href="/tags/spring.html">spring</a></li>
                            
                                    <li><a href="/tags/testing.html">testing</a></li>
                            
                                    <li><a href="/tags/vanilla.html">vanilla</a></li>
                            
                        </ul>
                    </li>
                </ul>
            </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
    </nav>

	
	<h1>Rendering Calendars</h1>

	<p><em><span class="glyphicon glyphicon-calendar"></span> 31 May 2008</em> ~ <a href='/tags/blog.html'><span class='label label-success'><span class='glyphicon glyphicon-tag'></span> blog</span></a>, <a href='/tags/java.html'><span class='label label-success'><span class='glyphicon glyphicon-tag'></span> java</span></a></p>

	<p><p>I am poking around with an idea I had to generate desktop background images with little calendars embedded in them and I<br/>realized that there is no really easy method of rendering your standard square text calendar display. I decided to play<br/>around with it a bit. The basic algorithm to generate the weeks and their associated days is nothing too complicated:</p>
<ol>
  <li>Figure out what day of the week the first day of the month falls on.</li>
  <li>Subtract from that the value for Sunday (the start of the week), which assumes that the day of the week field values are sequential (which they are).</li>
  <li>Iterate through the day of the month keeping track of the week breaks.</li>
</ol><p>I created a factory class, <code>MonthFactory</code> and a couple helper model objects, <code>Month</code> and <code>Week</code> to make things a little<br/>easier. <code>Month</code> and <code>Week</code> are pretty simple data objects used to store the month and week data in a meaningful structure.</p>
<pre><code class="java">public class Week {

    private final String[] days = new String[7];
    private int index = 0;

    public Iterable&lt;string&gt; days(){
        return Arrays.asList(days);
    }

    boolean append(final String day){
        days[index++] = day;
        return index != 7;
    }

    void padding(final int size){
        index = size;
    }

    @Override
    public String toString(){
        return Arrays.toString(days);
    }
}
</code></pre><p>I used strings to store the day values, you could also use ints.</p>
<pre><code class="java">public class Month {

    private final List&lt;Week&gt;; weeks = new LinkedList&lt;Week&gt;();
    private final String name;
    private final int year;

    Month(final String name, final int year){
        this.name = name;
        this.year = year;
    }

    public Iterable&lt;Week&gt; weeks(){
        return weeks;
    }

    public String getName(){return name;}

    public int getYear(){return year;}

    void append(final Week week){
        weeks.add(week);
    }

    @Override
    public String toString() {
        return &quot;{&quot; + name + &quot; &quot; + year + &quot;: weeks=&quot; + weeks.toString();
    }
}
</code></pre><p>Both of these classes have very limited public interfaces. They exist in the same package as the <code>MonthFactory</code> class which<br/>is used to build them. External client classes should really only be accessing them as read-only. The <code>MonthFactory</code> is also<br/>pretty simple, but it does contain the algorithm I mentioned earlier so it is the meat of the whole example:</p>
<pre><code class="java">public class MonthFactory {

    public static Month create(final int calendarMonth, final int year) throws Exception {
        validate(calendarMonth,year);

        final Calendar cal = Calendar.getInstance();
        cal.set(Calendar.MONTH, calendarMonth);
        cal.set(Calendar.DAY_OF_MONTH, 1);
        cal.set(Calendar.YEAR, year);

        final int daysInMonth = cal.getActualMaximum(Calendar.DAY_OF_MONTH);
        final String name = cal.getDisplayName(Calendar.MONTH,Calendar.LONG,Locale.getDefault());
        final Month month = new Month(name,year);

        Week week = new Week();
        week.padding(cal.get(Calendar.DAY_OF_WEEK) - Calendar.SUNDAY);

        for(int i=1; i&lt;=daysInMonth; i++){
            if(!week.append(String.valueOf(i))){
                month.append(week);
                week = new Week();
            }
        }

        month.append(week);

        return month;
    }

    private static void validate(final int calMon,final int year){
        if(calMon &lt; Calendar.JANUARY || calMon &gt; Calendar.DECEMBER){
            throw new IllegalArgumentException(&quot;Invalid Calendar Month specified: &quot; + calMon);
        }

        if(year &lt; 0){
            throw new IllegalArgumentException(&quot;Year must be non-negative: &quot; + year);
        }
    }
}
</code></pre><p>I even threw in some simple input validation for free. Now for a simple use of this code I created a <code>TextCalendar</code> class<br/>that simply generates a text calendar which will look right if it's rendered in a fixed-width font.</p>
<pre><code class="java">public class TextCalendar {
    public static void main(final String[] args) throws Exception {
        final Month month = MonthFactory.create(Calendar.JULY,2008);
        final StringBuilder str = new StringBuilder();
        final String header = month.getName() + &quot; &quot; + String.valueOf(month.getYear());
        str.append(padding(10 - header.length()/2,&#39; &#39;)).append(header).append(&#39;\n&#39;);

        for(final Week week : month.weeks()){
            for(final String day : week.days()){
                if(day == null){
                    str.append(&quot;  &quot;);
                } else {
                    str.append(day.length() == 2 ? day : &quot; &quot; + day);
                }
                str.append(&quot; &quot;);
            }
            str.append(&#39;\n&#39;);
        }

        System.out.println(str.toString());
    }

    private static String padding(final int size, final char val){
        final char[] pad = new char[size];
        Arrays.fill(pad, val);
        return new String(pad);
    }
}
</code></pre><p>This just serves to show how easy this makes calendar rendering. Upon running this little application you will get the<br/>following nicely formatted calendar (I even centered the header):</p>
<pre><code>     July 2008
       1  2  3  4  5
 6  7  8  9 10 11 12
13 14 15 16 17 18 19
20 21 22 23 24 25 26
27 28 29 30 31
</code></pre><p>If there are existing libraries to do this, I would love to hear about them. I could not find anything. Obviously this<br/>example corresponds to the standard US display of the Gregorian Calendar. I would think that it could be made to work<br/>for other calendars as well, but I have never actually seen any other calendars displayed... I guess I need to travel<br/>the world more. I provide these as examples only; there may be better ways to accomplish this and there are definitely<br/>code modifications and improvements that could be made. I am not currently using this code anywhere... it was just an<br/>experiment. Use at your own risk.</p></p>

	<hr />
	

            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12">
                    <hr>
                    <div style="text-align:center;">
                        <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a> CoffeaElectronica.com content is copyright &copy; 2016 <a href="http://stehno.com">Christopher J. Stehno</a> and available under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
                    </div>
                </div>
            </div>

        </div>

        <script src="js/jquery-1.12.4.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/prettify.js"></script>

        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-27165855-1', 'auto');
            ga('send', 'pageview');
        </script>
    </body>
</html>