
<html><head>
<title>XML Serialization</title>
<meta name="grackle.layout" content="post" />
<meta name="grackle.date-published" content="2009-11-27T19:52:00.000-06:00" />
</head><body>Another pair of those seemingly forgotten classes in the core Java API are the <tt>java.beans.XMLEncoder</tt> and <tt>java.beans.XMLDecoder</tt>. Added in 1.4, they don't really seem to be used all that much, that I have come across anyway. It seems that whenever someone needs to convert objects into xml, they instantly reach for 3rd-party libraries rather than looking in the core API. Not to downplay other APIs, but I do think XMLEncoder and XMLDecoder deserve consideration, especially when you simply need to export data objects in a simple and repeatable manner. <br /><a name='more'></a>First off, we need something to work with, how about a nice Person class:  <br /><br /><pre class="brush:java">public class Person {<br /> private String firstName, lastName;<br /> private short age;<br /><br /> public Person(){ super(); }<br /><br /> public Person(final String firstName, final String lastName, final short age){<br />  this.firstName = firstName;<br />  this.lastName = lastName;<br />  this.age = age;<br /> }<br /><br /> public String getFirstName() { return firstName; }<br /><br /> public void setFirstName(final String firstName) { this.firstName = firstName; }<br /><br /> public String getLastName() { return lastName; }<br /><br /> public void setLastName(final String lastName) { this.lastName = lastName; }<br /><br /> public short getAge() { return age; }<br /><br /> public void setAge(final short age) { this.age = age; }<br /><br /> @Override<br /> public String toString() { return firstName+" "+lastName+" ("+age+")"; }<br />}<br /></pre><br />It's nothing special, just first name, last name and age with getters and setters. I also overrode the <tt>toString()</tt> method so we can get something useful from it.  Now say you are in a situation where you need to quickly convert objects of the Person class to a format usable by another client (maybe another programming language); as much trouble as XML can be a times, it is still a good interoperability choice. Converting a collection of Person objects to XML is trivial:  <br /><br /><pre class="brush:java">final Collection&lt;Person&gt; people = new LinkedList&lt;Person&gt;();<br />people.add( new Person("Joe","Smith",(short) 32) );<br />people.add( new Person("Abe","Ableman",(short) 54) );<br />people.add( new Person("Cindy","Lindy",(short) 42) );<br /><br />final XMLEncoder encoder = new XMLEncoder( outputStream );<br />encoder.writeObject(people);<br />encoder.close();<br /></pre><br />Which will generate the following XML in the given output stream:  <br /><br /><pre class="brush:xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt; <br />&lt;java version="1.6.0_13" class="java.beans.XMLDecoder"&gt; <br /> &lt;object class="java.util.LinkedList"&gt; <br />  &lt;void method="add"&gt; <br />   &lt;object class="foo.Person"&gt; <br />    &lt;void property="age"&gt; <br />     &lt;short&gt;32&lt;/short&gt; <br />    &lt;/void&gt; <br />    &lt;void property="firstName"&gt; <br />     &lt;string&gt;Joe&lt;/string&gt; <br />    &lt;/void&gt; <br />    &lt;void property="lastName"&gt; <br />     &lt;string&gt;Smith&lt;/string&gt; <br />    &lt;/void&gt; <br />   &lt;/object&gt; <br />  &lt;/void&gt; <br />  &lt;void method="add"&gt; <br />   &lt;object class="foo.Person"&gt; <br />    &lt;void property="age"&gt; <br />     &lt;short&gt;54&lt;/short&gt; <br />    &lt;/void&gt; <br />    &lt;void property="firstName"&gt; <br />     &lt;string&gt;Abe&lt;/string&gt; <br />    &lt;/void&gt; <br />    &lt;void property="lastName"&gt; <br />     &lt;string&gt;Ableman&lt;/string&gt; <br />    &lt;/void&gt; <br />   &lt;/object&gt; <br />  &lt;/void&gt; <br />  &lt;void method="add"&gt; <br />   &lt;object class="foo.Person"&gt; <br />    &lt;void property="age"&gt; <br />     &lt;short&gt;42&lt;/short&gt; <br />    &lt;/void&gt; <br />    &lt;void property="firstName"&gt; <br />     &lt;string&gt;Cindy&lt;/string&gt; <br />    &lt;/void&gt; <br />    &lt;void property="lastName"&gt; <br />     &lt;string&gt;Lindy&lt;/string&gt; <br />    &lt;/void&gt; <br />   &lt;/object&gt; <br />  &lt;/void&gt; <br /> &lt;/object&gt; <br />&lt;/java&gt; <br /></pre><br />Yeah, it's not pretty and it's a bit on the verbose side, but it was easy to produce and easy to read. Now, if you want to read that back into Java objects, it it equally as simple:  <br /><br /><pre class="brush:java">final XMLDecoder decoder = new XMLDecoder( inputStream );<br />final Collection&lt;Person&gt; persons = (Collection&lt;Person&gt;)decoder.readObject();<br />decoder.close();<br /></pre><br />which will give you back copies of your original objects. If you were to call <tt>toString()</tt> on the resulting collection you would get:  <br /><br /><pre class="brush:text">[Joe Smith (32), Abe Ableman (54), Cindy Lindy (42)]<br /></pre><br />Exactly what you put in.  Obviously, this is not the best approach for serializing and deserializing data, but it's another tool in the tool box and I am always surprised by how few developers actually know that they are&nbsp;available.</body></html>
