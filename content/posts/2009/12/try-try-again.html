
<html><head>
<title>...Try Try Again</title>
<meta name="grackle.layout" content="post" />
<meta name="grackle.date-published" content="2009-12-20T09:33:00.000-06:00" />
</head><body>After yesterday's post, <a href="http://www.coffeaelectronica.com/2009/12/if-at-first-you-dont-succeed.html">If At First You Don't Succeed...</a>, I thought of a slightly different approach to the retry execution method:<br /><a name='more'></a> <br /><pre class="brush:java">public &lt;T&gt; T execute( final Retriable&lt;T&gt; op ) throws Exception {<br />    for(int r=0; r&lt;maxRetries; r++){<br />        try {<br />            return op.execute();<br /><br />        } catch(final Exception e) {<br />            if( ArrayUtils.contains(catchAndThrow, e.getClass()) ) throw e;<br /><br />            if(log.isWarnEnabled()){<br />                log.warn("RetryCaughtException[" + r + "]: " + e.getMessage());<br />            }<br />        }   <br />    }<br /><br />    if(log.isWarnEnabled()) {<br />        log.warn("RetriesFailed: " + op.getClass().getName());<br />    }    <br /><br />    throw new MaxRetriesExceededException(maxRetries,op.getClass().getName());<br />}<br /></pre><br />This approach does not rely on the boolean to end the loop. If an exception is thrown it will try again until a return value is returned or the retry count has been exceeded. With this approach you only fall out of the loop on a retry exceeded condition, hence the logging and the thrown exception. This feels a little cleaner than the other approach.  I have not run it through the unit testing so, you might do that first if you intend to use this code.</body></html>
