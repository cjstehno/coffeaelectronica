
<html><head>
<title>CruiseControl Project Operations</title>
<meta name="grackle.layout" content="post" />
<meta name="grackle.date-published" content="2008-02-07T18:06:00.000-06:00" />
</head><body>One of the developers I work with figured out the URL for firing the various CruiseControl build operations (resume, pause, build, etc) and it was jokingly noted that now all we need is a <a href="http://ruby-lang.org/">Ruby</a> script to fire them.<br /><a name='more'></a>And so, viola! Here is a simple ruby script that will do just that. It will run the specified operation command on one project (or all if no project is specified). You do have to configure the script with your CruiseControl url and your project names, but it's well worth it.  <br /><br /><pre class="brush:ruby">#<br /># exec_in_cc.rb<br />#<br /># Used to perform actions on the projects managed by CruiseControl. <br /># If no project is specified, the given operation will be run on all projects (internal array of them).<br />#<br /># ruby exec_in_cc.rb operation [project]<br />#<br /># Christopher J. Stehno (2/7/2008)<br />#<br />require 'net/http'<br />require 'uri'<br />   <br /># customize these to fit your pojects<br />cruise_url = 'http://builder:8000'<br />projects = ['nightly-build','releases','site-build']<br />   <br /># require the operation param<br />if ARGV[0] == nil<br />    puts "You must specify an operation!"<br />    exit<br />else <br />    operation = ARGV[0]<br />end<br />    <br /># check for specified project, if none use all of them<br />unless ARGV[1] == nil then projects = [ARGV[1]] end<br />    <br />projects.each {|project|<br />    url = URI.parse(cruise_url)<br />    res = Net::HTTP.start(url.host, url.port) {|http|<br />        http.get("/invoke?operation=#{operation}&amp;objectname=CruiseControl+Project%3Aname%3D#{project}")<br />    }<br />    success = res.body.index('Invocation successful') != nil ? 'Success' : 'Failed'<br />    puts "#{project}.#{operation}: #{success}"<br />}<br /></pre><br />This took about 30 minutes to write and will save at least that much time over the life of its use. Ruby is excellent for this kind of scripting. Something I have tried to do more often is to script tasks like this. You may feel that you are wasting time when you should be doing other things, but usually with a repetitive task like this you really notice the value. If you find it useful or come up with some good improvements to it, I would love to hear about them.</body></html>
